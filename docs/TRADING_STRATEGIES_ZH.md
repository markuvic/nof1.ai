# 交易策略配置指南

本文档详细说明 open-nof1.ai 系统支持的所有交易策略及其配置方法。

## 策略概览

系统目前支持 **5 种交易策略**，适应不同的市场环境和风险偏好：

| 策略代码 | 策略名称 | 执行周期 | 持仓时长 | 风险等级 | 适合人群 |
|---------|---------|---------|---------|---------|---------|
| `ultra-short` | 超短线 | 5分钟 | 30分钟-2小时 | 中高 | 喜欢高频交易、快进快出的交易者 |
| `swing-trend` | **波段趋势** | **20分钟** | **数小时-3天** | **中低** | **追求中长期趋势、稳健成长的投资者** |
| `conservative` | 稳健 | 5-15分钟 | 数小时-24小时 | 低 | 保守投资者 |
| `balanced` | 平衡 | 5-15分钟 | 数小时-24小时 | 中 | 一般投资者 |
| `aggressive` | 激进 | 5-15分钟 | 数小时-24小时 | 高 | 激进投资者 |

## 策略详细说明

### 🚀 超短线策略 (`ultra-short`)

**核心理念**：快进快出，捕捉短期价格波动，严格执行锁利规则

#### 策略参数
- **执行周期**：5分钟
- **建议持仓时长**：30分钟 - 2小时
- **杠杆范围**：3-5倍（根据MAX_LEVERAGE的50%-75%）
- **仓位大小**：18-25%
- **止损范围**：-1.5% ~ -2.5%

#### 风控规则（系统强制执行）
1. **周期锁利规则**：每个5分钟周期内，盈利>2%且<4%时，立即平仓锁定利润
2. **30分钟规则**：持仓超过30分钟且盈利>手续费成本时，如未达移动止盈线，执行保守平仓
3. **移动止盈**：
   - 盈利≥+4% → 止损移至+1.5%
   - 盈利≥+8% → 止损移至+4%
   - 盈利≥+15% → 止损移至+8%

#### 适用场景
- 市场波动剧烈，短期趋势明确
- 有充足时间监控系统运行
- 追求快速资金周转

#### 配置示例
```bash
TRADING_STRATEGY=ultra-short
TRADING_INTERVAL_MINUTES=5
MAX_LEVERAGE=10
```

---

### 🌊 波段趋势策略 (`swing-trend`) ⭐ **推荐新策略**

**核心理念**：捕捉中期趋势，耐心等待高质量信号，让利润充分奔跑

#### 策略参数
- **执行周期**：**20分钟**
- **建议持仓时长**：**数小时 - 3天**
- **杠杆范围**：**2-5倍**（根据MAX_LEVERAGE的20%-50%，更保守）
- **仓位大小**：**12-20%**（更小仓位，降低风险）
- **止损范围**：**-5% ~ -8%**（更宽止损，给趋势足够空间）

#### 核心优势
1. **降低交易频率**：20分钟执行周期，减少过度交易
2. **更低杠杆**：2-5倍杠杆，大幅降低波动风险
3. **更宽止损**：-5%~-8%止损，避免被短期噪音洗出
4. **追求趋势利润**：首次止盈目标+50%，最高可达+120%
5. **更长持仓**：可持仓数天，充分享受趋势红利

#### 移动止盈策略
```
盈利≥+15% → 止损移至+8%   (保护至少8%利润)
盈利≥+30% → 止损移至+20%  (保护至少20%利润)
盈利≥+50% → 止损移至+35%  (保护至少35%利润)
```

#### 分批止盈策略
```
盈利≥+50%  → 平仓40%（保留60%继续持有）
盈利≥+80%  → 平仓剩余60%（累计平仓100%）
盈利≥+120% → 全部清仓（避免贪婪）
```

#### 入场条件（AI执行）
- **至少3个以上时间框架信号强烈一致**
- **优先分析15分钟 - 4小时级别K线**
- **等待明确趋势形成，不追求交易频率**
- **重视趋势质量而非数量**

#### 系统风控提醒（非强制）
1. **72小时持仓提醒**：超过3天持仓，系统提醒AI重新评估趋势
2. **长期亏损警告**：持仓>24小时且亏损<-3%，提示可能判断错误
3. **趋势衰竭检测**：峰值盈利后回撤>8%且时间较长，提示趋势可能衰竭

#### 适用场景
- **市场处于明确的上升或下降趋势**
- **追求中长期稳定收益，不急于短期获利**
- **希望降低交易频率，减少心理负担**
- **资金规模较大，重视风险控制**

#### 配置示例（推荐）
```bash
# 环境变量配置
TRADING_STRATEGY=swing-trend
TRADING_INTERVAL_MINUTES=20
MAX_LEVERAGE=10  # 策略实际使用2-5倍，留足安全边际
MAX_POSITIONS=3  # 建议减少同时持仓数量
INITIAL_BALANCE=2000
```

#### 预期收益
- **月目标收益**：15-35%
- **胜率目标**：60-70%
- **盈亏比目标**：≥3:1（止盈目标50-120%，止损5-8%）
- **夏普比率**：≥1.5

#### 与超短线策略对比

| 维度 | 超短线 (ultra-short) | 波段趋势 (swing-trend) |
|-----|---------------------|---------------------|
| 执行周期 | 5分钟 | **20分钟** ⬆️ |
| 杠杆倍数 | 3-5倍 | **2-5倍** ⬇️ |
| 仓位大小 | 18-25% | **12-20%** ⬇️ |
| 止损幅度 | -1.5%~-2.5% | **-5%~-8%** ⬆️ |
| 首次止盈 | +15% | **+50%** ⬆️⬆️ |
| 持仓时长 | 30分钟-2小时 | **数小时-3天** ⬆️⬆️ |
| 交易频率 | 高频快进快出 | **低频精选趋势** ⬇️ |
| 风险等级 | 中高 | **中低** ⬇️ |
| 强制规则 | 2%周期锁利、30分钟平仓 | **仅监控提醒，AI自主决策** |
| 适合行情 | 短期波动 | **中期趋势** |

---

### 🛡️ 稳健策略 (`conservative`)

**核心理念**：保护本金优先，低风险低杠杆

#### 策略参数
- **杠杆范围**：2-6倍
- **仓位大小**：15-22%
- **止损范围**：-2.5% ~ -3.5%

#### 移动止盈
- 盈利≥+6% → 止损移至+2%
- 盈利≥+12% → 止损移至+6%
- 盈利≥+20% → 止损移至+12%

---

### ⚖️ 平衡策略 (`balanced`)

**核心理念**：风险收益平衡，适合大多数投资者

#### 策略参数
- **杠杆范围**：6-8倍
- **仓位大小**：20-27%
- **止损范围**：-2% ~ -3%

#### 移动止盈
- 盈利≥+8% → 止损移至+3%
- 盈利≥+15% → 止损移至+8%
- 盈利≥+25% → 止损移至+15%

---

### 🔥 激进策略 (`aggressive`)

**核心理念**：追求高收益，承担高风险

#### 策略参数
- **杠杆范围**：8-10倍
- **仓位大小**：25-32%
- **止损范围**：-1.5% ~ -2.5%

#### 移动止盈
- 盈利≥+10% → 止损移至+4%
- 盈利≥+18% → 止损移至+10%
- 盈利≥+30% → 止损移至+18%

---

## 策略切换指南

### 何时使用波段趋势策略？

✅ **推荐使用场景**：
- 市场出现明确的上升或下降趋势（多个时间框架趋势一致）
- 你希望降低交易频率，减少情绪干扰
- 资金规模较大，重视稳健增长
- 你能接受更长的持仓周期（数小时到数天）
- 你追求更大的单笔收益（50-120%目标）

❌ **不推荐使用场景**：
- 市场处于震荡盘整，无明确趋势
- 你需要快速资金周转
- 你无法接受数天的持仓周期
- 市场波动极大，趋势不稳定

### 何时使用超短线策略？

✅ **推荐使用场景**：
- 市场波动频繁，短期趋势明确
- 你有充足时间监控系统
- 你喜欢快进快出的交易节奏
- 资金规模较小，需要快速积累

### 策略切换步骤

1. **平仓所有持仓**（避免策略冲突）
2. **修改环境变量**：
   ```bash
   # 切换到波段趋势策略
   TRADING_STRATEGY=swing-trend
   TRADING_INTERVAL_MINUTES=20
   
   # 或切换到超短线策略
   TRADING_STRATEGY=ultra-short
   TRADING_INTERVAL_MINUTES=5
   ```
3. **重启系统**：
   ```bash
   docker-compose down
   docker-compose up -d
   ```

---

## 风控对比

### 系统硬性底线（所有策略共同）
- **极端止损**：单笔亏损≤-30%强制平仓（防止爆仓）
- **36小时限制**：任何持仓超过36小时强制平仓（释放资金）
- **账户回撤保护**：账户总回撤达到预设阈值时触发保护

### 策略专属风控

| 策略 | 专属风控规则 | 特点 |
|-----|-------------|-----|
| ultra-short | • 2%周期锁利<br>• 30分钟盈利平仓 | 系统**强制执行** |
| swing-trend | • 72小时持仓提醒<br>• 长期亏损警告<br>• 趋势衰竭检测 | 系统**仅提醒**，AI自主决策 |
| conservative/balanced/aggressive | 无专属规则 | AI全权决策 |

---

## 最佳实践建议

### 波段趋势策略最佳实践

1. **耐心等待信号**
   - 不要急于开仓，等待至少3个时间框架确认
   - 优先关注15分钟、1小时、4小时级别的趋势

2. **严格执行移动止盈**
   - 盈利达到+15%时，务必将止损移至+8%
   - 给利润足够空间，但保护已有收益

3. **合理使用杠杆**
   - 普通信号：2倍杠杆（最安全）
   - 良好信号：3倍杠杆（平衡）
   - 强信号：5倍杠杆（最大值，谨慎使用）

4. **控制同时持仓数**
   - 建议：1-3个持仓（`MAX_POSITIONS=3`）
   - 避免过度分散，保持资金集中度

5. **关注趋势质量**
   - 重视趋势的强度和稳定性
   - 宁可错过机会，不可盲目开仓
   - 一周2-3笔高质量交易，远胜10笔平庸交易

### 超短线策略最佳实践

1. **快进快出**
   - 盈利>2%立即考虑锁利
   - 不要贪婪，小利润也是利润

2. **严格遵守规则**
   - 系统的2%锁利和30分钟规则是经验总结
   - 不要试图手动干预

3. **高频监控**
   - 5分钟周期需要更频繁的监控
   - 确保系统稳定运行

---

## 配置示例

### 生产环境 - 波段趋势策略（推荐）

```bash
# .env 文件配置

# 策略配置
TRADING_STRATEGY=swing-trend           # 使用波段趋势策略
TRADING_INTERVAL_MINUTES=20            # 20分钟执行周期

# 风控配置
MAX_LEVERAGE=10                        # 最大杠杆10倍（策略实际使用2-5倍）
MAX_POSITIONS=3                        # 最多3个持仓
MAX_HOLDING_HOURS=72                   # 最大持仓72小时（3天）
INITIAL_BALANCE=2000                   # 初始资金2000 USDT

# 账户风控
ACCOUNT_STOP_LOSS_USDT=1500           # 账户止损线
ACCOUNT_TAKE_PROFIT_USDT=3000         # 账户止盈线

# API配置
GATE_API_KEY=your_api_key
GATE_API_SECRET=your_api_secret
GATE_USE_TESTNET=false                # 生产环境

# AI配置
OPENAI_API_KEY=your_openai_key
OPENAI_BASE_URL=https://openrouter.ai/api/v1
AI_MODEL_NAME=deepseek/deepseek-v3.2-exp
```

### 测试环境 - 超短线策略

```bash
# 策略配置
TRADING_STRATEGY=ultra-short           # 使用超短线策略
TRADING_INTERVAL_MINUTES=5             # 5分钟执行周期

# 风控配置
MAX_LEVERAGE=10
MAX_POSITIONS=5                        # 超短线可以持仓更多
MAX_HOLDING_HOURS=36
INITIAL_BALANCE=1000                   # 测试环境小资金

# 测试网络
GATE_USE_TESTNET=true                  # 使用测试网
```

---

## 常见问题

### Q1: 波段趋势策略会不会错过短期机会？
**A**: 是的，波段策略会放弃很多短期波动机会。但这是策略特点，不是缺陷。通过降低交易频率，专注于高质量趋势，可以获得更高的胜率和盈亏比，长期收益更稳定。

### Q2: 为什么波段策略的杠杆更低？
**A**: 因为持仓时间更长（数天），市场可能经历更大的波动。低杠杆（2-5倍）可以有效降低爆仓风险，配合更宽的止损（-5%~-8%），避免被短期噪音洗出。

### Q3: 波段策略的止盈目标（+50%起）会不会太高？
**A**: 对于短线交易来说确实很高，但对于波段交易是合理的。一个稳定的中期趋势完全可以提供50%以上的收益空间。而且策略设计了分批止盈（+50%平仓40%），既锁定部分利润，又给剩余持仓追求更高收益的机会。

### Q4: 可以同时运行多个策略吗？
**A**: 不建议。每个策略有不同的风控规则和执行逻辑，同时运行可能导致冲突。建议根据市场状况选择一个策略专注执行。

### Q5: 如何评估策略效果？
**A**: 关注这些指标：
- **胜率**：盈利交易占比（目标≥60%）
- **盈亏比**：平均盈利/平均亏损（目标≥2.5:1）
- **月收益率**：月度总收益（波段策略目标15-35%）
- **夏普比率**：风险调整后收益（目标≥1.5）
- **最大回撤**：峰值到低谷的最大跌幅（控制在20%以内）

---

## 技术支持

如有问题或建议，请通过以下方式联系：

- **GitHub Issues**: [https://github.com/195440/open-nof1.ai/issues](https://github.com/195440/open-nof1.ai/issues)
- **讨论区**: [https://github.com/195440/open-nof1.ai/discussions](https://github.com/195440/open-nof1.ai/discussions)

---

## 版权声明

Copyright (C) 2025 195440

本文档遵循 GNU Affero General Public License v3.0 协议。

